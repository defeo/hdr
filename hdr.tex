\documentclass{report}

\usepackage[b5paper]{geometry}
\usepackage[english]{babel}
\usepackage{array}
\usepackage{amsmath,amsthm,amsfonts,amssymb}
\usepackage{unicode}
\usepackage[type={CC},modifier={by-nc-sa},imagemodifier={-eu},version={4.0},imagewidth=5em]{doclicense}
\usepackage{fancyhdr}

\usepackage{algorithmic}
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}
\algsetup{linenodelimiter=.}

\usepackage[pdfusetitle]{hyperref}
\hypersetup{
  unicode=true,
  colorlinks=true,
  citecolor=blue!70!black,
  filecolor=black,
  linkcolor=red!70!black,
  urlcolor=blue,
  pdfstartview={FitH},
  pdfauthor={Luca De Feo},
  pdfsubject={Mathematics},
  pdfkeywords={Cryptography, Number theory, Computer algebra, Elliptic curves, Isogenies, Finite fields},
}

\usepackage{tikz}
\usetikzlibrary{arrows,matrix,decorations,decorations.text,decorations.pathmorphing,calc}
\pgfkeys{/triangle/.code=\tikzset{x={(-0.5cm,-0.866cm)},y={(1cm,0cm)}}}
\pgfkeys{/lattice/.code n args={4}{\tikzset{cm={#1,#2,#3,#4,(0,0)}}}}

% theorem environments
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{problem}{Problem}

\include{preamble}

\title{Promenades in isogeny graphs}
%\subtitle{Habilitation à diriger des recherches}
\author{Luca De Feo}

\begin{document}

\maketitle
\thispagestyle{fancy}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0.4pt}
\cfoot{\doclicenseThis}
\lfoot{\LaTeX{} source code available at \url{https://github.com/defeo/hdr/}.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Intro, etc.}

We'll take a journey, from one lonely elliptic curve over a finite
field to the amazingly rich world of isogeny graphs.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Finite fields and elliptic curves}

As short as possible, maybe write after, maybe an appendix.

- projective space, projective varieties,
- elliptic curves, torsion
- function fields, algebraic maps, frobenius, degree


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{The neighborhood}

% \begin{verse}
% You climb out the chimney\\
% And meet me in the middle\\
% The middle of the town\\
% And since there's no one else around,\\
% We let our hair grow long and forget all we used to know\\
% Then our skin gets thicker from living out in the snow
%
% Arcade Fire, The neighborhood #1 (Tunnels)
% \end{verse}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Isogenies}

An isogeny is a non-constant algebraic map between elliptic curves,
preserving the point at infinity. %
An isogeny is also a surjective group morphism of elliptic curves. %
It turns out these definitions are equivalent, but, before getting
these pages drenched in more properties and theorems, let's have a
look at an example.

The map $ϕ$ from the elliptic curve $y^2=x^3+x$ to $y^2=x^3-4x$
defined by
\begin{equation}
  \label{eq:isog-example}
  \begin{aligned}
    ϕ(x,y) &= \left(\frac{x^2+1}{x},y\frac{x^2-1}{x^2}\right),\\
    ϕ(\O) &= \O
  \end{aligned}
\end{equation}
is an isogeny. %
As an algebraic map it has degree $2$, which implies that it is a
two-to-one map, as it can be inferred from the polynomial degrees. %
Our rational maps are not defined at $x=0$, but the first expression
should really be understood as the projective map
\begin{equation*}
  ϕ(X:Y:Z) = \bigl(X(X^2+Z^2):Y(X^2-Z^2):ZX^2\bigr),
\end{equation*}
showing that the only other point in $\ker ϕ$, besides $\O$, is
$(0:0:1)$.


\begin{figure}
  \centering
  \begin{tikzpicture}[x=0.03\textwidth,y=0.03\textwidth]
    \begin{scope}
      \node[anchor=center] at (0,7) {$E \;:\; y^2 = x^3 + x$};

      \draw[thin,gray] (0,-6) -- (0,6);
      \draw[thin,gray] (-6,0) -- (6,0);

      \foreach \x/\y in {0/0,5/3,-4/3,-3/5,-2/1,-1/3} {
        \draw[blue,fill] (\x,\y) circle (0.2) node(E_\x_\y){}
        (\x,-\y) circle (0.2) node(E_\x_-\y){};
      }
    \end{scope}

    \draw[black!10!white,thick] (8,-7) -- +(0,14);
    
    \begin{scope}[shift={(16,0)}]
      \node at (0,7) {$E' \;:\; y^2 = x^3 - 4x$};

      \draw[thin,gray] (0,-6) -- (0,6);
      \draw[thin,gray] (-6,0) -- (6,0);

      \foreach \x/\y in {0/0,2/0,3/2,4/2,6/4,-2/0,-1/5} {
        \draw[color=blue,fill] (\x,\y) circle (0.2) node(F_\x_\y){}
        (\x,-\y) circle (0.2) node(F_\x_-\y){};
      }
    \end{scope}

    \begin{scope}[color=red,-latex,dashed]
        \path
        (E_5_3) edge (F_3_2)
        (E_-4_3) edge (F_4_-2)
        (E_-3_5) edge (F_4_2)
        (E_-2_1) edge (F_3_-2)
        (E_-1_3) edge (F_-2_0);
        \path
        (E_5_-3) edge (F_3_-2)
        (E_-4_-3) edge (F_4_2)
        (E_-3_-5) edge (F_4_-2)
        (E_-2_-1) edge (F_3_2)
        (E_-1_-3) edge (F_-2_0);
    \end{scope}
  \end{tikzpicture}
  \caption{The isogeny $(x,y) \mapsto \bigl((x^2+1)/x,\;y(x^2-1)/x^2\bigr)$,
    as a map between curves defined over $\F_{11}$.}
  \label{fig:isog-example}
\end{figure}


What does an isogeny ``look like''? %
Drawing the above one in $\R^2$ would look rather messy, but an
isogeny defined over the rationals is still an isogeny if we reduce
modulo a prime $p$. %
Figure~\ref{fig:isog-example} plots the action of the
isogeny~\eqref{eq:isog-example} on the image of the curves in
$\F_{11}$. %
A red arrow indicates that a point of the left curve is sent onto a
point on the right curve; the action on the point in $(0,0)$, going to
the point at infinity, is not shown. %
We observe a symmetry with respect to the $x$-axis, a consequence of
the fact that $ϕ$ is a group morphism; and, by looking closer, we may
also notice that collinear points are sent to collinear points, also a
necessity for a group morphism. %

Something strikes us, though: the map looks by no means surjective! %
This is because, when we think of isogenies, we think of them as
geometric objects, acting on the extension of the curves to the
algebraic closure. %
This is not dissimilar from the way power-by-$n$ maps act on the
multiplicative group $k^\times$ of a field $k$: the map $x↦x^2$, for
example, is a two-to-one (algebraic) group morphism on
$\F_{11}^\times$, and those elements that have no preimage, the
non-squares, will have exactly two square roots in $\F_{11^2}$, and so
on. %
In much the same way, in an algebraic closure $\bar{\F}_{11}$ of
$\F_{11}$, the isogeny $ϕ$ becomes surjective and every point gains
exactly two antecedents. %
This analogy is more profound that it may seem, and shall bear its
fruits in Chapter~\ref{cha:fpbar}.

For elliptic curves defined over a field of characteristic $p>0$,
there is another kind of isogeny. %
Let $E:y^2=x^3+ax+b$ be an elliptic curve, let $q$ be a power of $p$, and let
$E^{(q)}:y^2=x^3+a^qpx+b^q$. %
The isogeny $π_q:E\to E^{(q)}$ defined by
\begin{equation}
  \begin{aligned}
    π_q(x,y) &= (x^q,y^q),\\
    π_q(\O) &= \O
  \end{aligned}
\end{equation}
is a \emph{purely inseparable} isogeny of degree $q$. %
We call $π_q$ a \emph{Frobenius isogeny}. %
Despite being of degree $q$, Frobenius isogenies have trivial kernel,
and are one-to-one over finite fields (and other perfect fields). %

% Plotting the action of $π_p$ on the curve of
% Figure~\ref{fig:isog-example} would not be very telling, since in this
% case $E^{(p)}=E$ and the map acts like the identity on $\F_{11}$. %
% However $π_p$ is an important map, called the \emph{Frobenius
%   endomorphism} of $E$, and often denoted simply by $π$. %
% It permutes the points of $E/\bar{\F}_{11}$ in a non trivial way,
% reflecting the action of the Galois group of $\bar{\F}_{11}/\F_{11}$
% on $E$. %

Any isogeny can be decomposed as a product of a Frobenius isogeny and
a \emph{separable} isogeny:
\begin{equation*}
  \begin{tikzpicture}
    \node(E) at (0,0) {$E$};
    \node(Ep) at (2,0) {$E^{(q)}$};
    \node(E') at (4,0) {$E'$};
    \draw[->,auto] (E) edge node{\small $π_q$} (Ep)
    (Ep) edge node{\small $ϕ_s$} (E')
    (E) edge[bend right=20] node[below]{\small $ϕ$} (E');
  \end{tikzpicture}
\end{equation*}
Computing this decomposition is also easy given rational functions for
$ϕ$: simply factor out the powers of $p$ from the polynomials. %
For these reasons we shall be mostly concerned with separable
isogenies and their computations.

The most unique property of separable isogenies is that they are 
entirely determined by their kernel. %

\begin{proposition}
  Let $E$ be an elliptic curve, and let $G$ be a finite subgroup of
  $E$. %
  There is a curve $E'$, and a separable isogeny $ϕ$, such that
  $\ker ϕ=G$ and $ϕ:E\to E'$. %
  Furthermore, $E'$ and $ϕ$ are unique up to composition with an
  isomorphism $E'≃E''$. %
\end{proposition}

Said otherwise, for any finite subgroup $G⊂E$, we have an exact
sequence of algebraic groups
\begin{equation*}
  0 \to G \to E \overset{ϕ}{\to} E' \to 0.
\end{equation*}
Uniqueness justifies the notation $E/G$ for the image isomorphism
class of the curve $E'$. %
Conversely, since any non-constant morphism of algebraic curves
necessarily has finite kernel, we have a canonical bijection between
the finite subgroups of a curve $E$ and the isogenies with domain
$E$. %
This correspondence is rich in consequences: it is an easy exercise to
prove the following useful facts. %

\begin{corollary}\ 
  \begin{enumerate}
  \item Any isogeny can be decomposed as a product of prime degree
    isogenies.
  \item Let $E$ be defined over an algebraically closed field $k$, let
    $ℓ$ be a prime different from the characteristic of $k$, then
    there are exactly $ℓ+1$ isogenies of degree $ℓ$ with domain $E$,
    up to isomorphisms of $E/G$.
  \end{enumerate}
\end{corollary}

Slightly less more work is required to prove the following,
fundamental, theorem (the difficulty comes essentially from the
inseparable part, see~\cite[III.6.1]{silverman:elliptic} for a
detailed proof).

\begin{theorem}[Dual isogeny theorem]
  Let $ϕ:E\to E'$ be an isogeny of degree $m$. %
  There is a unique isogeny $\hat{ϕ}:E'\to E$ such that
  \[\hat{ϕ}∘ϕ = [m]_E, \quad ϕ∘\hat{ϕ} = [m]_{E'}.\] %
  $\hat{ϕ}$ is called the \emph{dual isogeny of $ϕ$}; it has the
  following properties:
  
  \begin{enumerate}
  \item $\hat{ϕ}$ has degree $m$;
  \item $\hat{ϕ}$ is defined over $k$ if and only if $ϕ$ is;
  \item $\widehat{ψ∘ϕ} = \hat{ϕ}∘\hat{ψ}$ for any isogeny $ψ:E'\to E''$;
  \item $\widehat{ψ+ϕ} = \hat{ψ} + \hat{ϕ}$ for any isogeny $ψ:E\to E'$;
  \item $\deg ϕ = \deg\hat{ϕ}$;
  \item $\hat{\hat{ϕ}} = ϕ$.
  \end{enumerate}
\end{theorem}


The computational counterpart to the kernel-isogeny correspondence, is
given by V\'elu's much celebrated formulas. %

\begin{proposition}[{V\'elu~\cite{velu71}}]
  \label{th:velu}
  Let $E:y^2=x^3+ax+b$ be an elliptic curve defined over a field $k$,
  and let $G⊂E(\bar{k})$ be a finite subgroup. %
  The separable isogeny $ϕ:E\to E/G$, of kernel $G$, can be written as
  \begin{equation*}
    ϕ(P) = \left(
      x(P) + \sum_{Q∈G\setminus\{\O\}}x(P+Q)-x(Q),
      y(P) + \sum_{Q∈G\setminus\{\O\}}y(P+Q)-y(Q)
    \right);
  \end{equation*} %
  and the curve $E/G$ has equation $y^2=x^3+a'x+b'$, where
  \begin{align*}
    a' &= a - 5\sum_{Q∈G\setminus\{\O\}}(3x(Q)^2+a),\\
    b' &= b - 7\sum_{Q∈G\setminus\{\O\}}(5x(Q)^3+3ax(Q)+b).
  \end{align*}
\end{proposition}

In summary, knowledge of its kernel allows us to compute an isogeny,
and \emph{vice versa}. %
This will be crucial when we will study isogeny-based cryptosystems
in Chapter~\ref{cha:crypto}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{The explicit isogeny and other problems}

When it comes to computations, V\'elu's formulas are only part of the
story. %
Instead of being given a kernel $G$ and wanting to compute the curve
$E/G$, we may ask the opposite question. %
Elkies, while working on point counting~\cite{elkies92,elkies98},
famously baptized this the \emph{explicit isogeny problem}.

\begin{problem}[Explicit isogeny problem]
  Let $E$ and $E'$ be two elliptic curves, and $ℓ$ an integer. %
  Decide whether there exists an isogeny $ϕ:E\to E'$ of degree $ℓ$,
  and compute its kernel.
\end{problem}

The explicitly isogeny problem has kept the research community busy
for more than twenty years, and, with different variations, still does
today. %
Let's have a closer look at it. %

For a start, it should be noticed that it is by no means a ``hard''
problem. %
Indeed, we have explicit formulas for adding points on a curve $E$,
from which we can deduce an explicit formula for multiplying points on
$E$ by any scalar $ℓ∈ℤ$. %
Said otherwise, we have an explicitly formula for the
multiplication-by-$ℓ$ isogeny, and, by reading its denominators, we
can deduce a polynomial $ψ_ℓ(x,y)$ that vanishes precisely on $E[ℓ]$,
the \emph{$ℓ$-th division polynomial} of $E$
(see~\cite[III.4]{blake+seroussi+smart} for explicit formulas). %

Let's assume for simplicity that $ℓ$ is prime and different from the
characteristic, then we know there are at most $ℓ+1$ isogenies of
degree $ℓ$ from $E$. %
Factoring $ψ_ℓ$ over the field of definition $k$ of $E$ lets us
compute all possible kernels of order $ℓ$, and thus all possible
isogenies. %
At most $ℓ+1$ applications of V\'elu's formula will then give the
answer to the explicit isogeny problem. %
$ψ_ℓ$ can be reduced to a univariate polynomial in $x$, and, since
$E[ℓ]$ contains $ℓ^2$ points, its degree is bounded by $ℓ^2$, thus
this algorithm costs no more than factoring a degree $ℓ^2$ polynomial
in $k[x]$. %

We see that the matter is not solving the explicit isogeny
problem. The matter is solving it fast!

An interesting case, and the one Elkies was originally interested in,
is when the curves are defined over a finite field. %
Let's relax the problem a bit, and see what can be told about it. %
Decisional versions, first: two elliptic curves are said to be
\emph{isogenous} if there exists an isogeny connecting them (this is
an equivalence relation, thanks to the dual isogeny theorem).

\begin{problem}
  \label{prob:isogenous}
  Let $E,E'$ be two elliptic curves defined over a finite field
  $\F_q$, decide whether they are isogenous.
\end{problem}

Tate~\cite[Th.~1(c)]{Tate} famously showed\footnote{Tate, citing
  Mumford, also points out that, for the case of elliptic curves, this
  is an easy consequence of the much celebrated work of
  Deuring~\cite{deuring41}.} that $E$ and $E'$ are isogenous over
$\F_q$ if and only if $\#E(\F_q)=\#E'(\F_q)$. %
Schoof's point counting algorithm~\cite{schoof85,schoof95} completely
settles the problem by computing the orders of $E$ and $E'$ in
polynomial time in $\log(q)$. %

Getting back to the decisional version of the explicit isogeny
problem, the constraint on the isogeny degree makes the problem
harder, even over finite fields. %
The \emph{modular polynomial} helps with that. %
Assuming $ℓ$ is prime, the $ℓ$-th modular polynomial, denoted by
$Φ_ℓ(X,Y)$, it is a bivariate polynomial with coefficients in $ℤ$,
symmetric in $X$ and $Y$, of degree $ℓ+1$ in each variable, with the
following property: two elliptic curves $E,E'$ are $ℓ$-isogenous if
and only if $Φ_ℓ(j(E),j(E'))=Φ_ℓ(j(E'),j(E))=0$. %
We stress that this is true over \textbf{any} field, and that the
definition of $Φ_ℓ$ is independent of the base field. %
Given that $Φ_ℓ$ has $O(ℓ^2)$ coefficients (and rather large ones),
using it to decide the explicit isogeny problem is asymptotically
comparable to factoring the division polynomial; it is however usually
more efficient in practice, especially when tables of modular
polynomials are precomputed, as is the case in computer algebra
systems such as Pari~\cite{Pari}, Magma~\cite{MAGMA}, or
SageMath~\cite{Sage}. %

- normalized isogenies
- Elkies
- Couveignes, Lercier 
- Schoof

- How to compute an isogeny,
- Modular polynomials, application to point counting

\section{Curling up}

- Isogeny graphs, Serre trees?
- Isogeny volcanoes, complex multiplication
- Supersingular graphs

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Panoptycon}
\label{cha:fpbar}

- towers of finite fields,
- isomorphisms, embeddings,
- Fp-bar
- lattices

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Crypto and quantum computers}
\label{cha:crypto}

- Expander graphs
- HHS, CSIDH
- SIDH
- Signatures?
- Quantum algorithms? Kuperberg?

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\clearpage
\bibliographystyle{plain}
\bibliography{hdr}

\end{document}

% LocalWords:  isogeny isogenies morphism surjective projective
% LocalWords:  preimage bijection cryptosystems univariate Decisional
% LocalWords:  isomorphisms isogenous Schoof's decisional bivariate
% LocalWords:  precomputed
